

<h1>Available Starports</h1>
<table class="table table-striped table-bordered">
  <% @planets.each do |p|%>
  <% unless @shipshelper.get_available_ships(p).empty? %>


      
      <tr>
      
        
        <td><%= link_to p.name , controller: "starport", action: "show", id: p  %></td>
      </tr>

      <% end %>
      <% end %>
</table>
<% unless @queue.empty? %>
<h3>Ships to build:</h3>
<table class="table table-striped table-bordered" id="shipdata">
	<thead>
  <tr>
		<th>Planet</th>
		<th>Ship</th>
		<th>Time (seconds)</th>
    <th></th>
	</tr>
</thead>
  <tbody>
    <% i=0 %>
	<% @queue.each do |q| %>
		<tr>
			<td><%= q.planet.name %></td>
			<td> <%= @ships.find(q.ship_id).name %> </td>
      <% if (q.end_time - @time.now.to_i) <= 0 %>
        <td>0</td>
      <% else %>

			<td><%= (q.end_time - @time.now.to_i) %></td>
<!-- 			<td><div class="bar" style="width: <%= q.end_time - @time.now.to_i %>%;"></div></td> -->
    <%end%>
    <td><input type='button' class="destroy-button" value='destroy' name='destroy' data-zeile='<%= i%>' id='<%= q.id %>' /></td>
    <% i+=1 %>
		</tr>
	<% end %>
<% end %>
</tbody>
</table>
<script>
$(document).ready(function() {
    $('#shipdata').dataTable({
  "sDom":  "<'row'<'span4'l>r>t<'row'<'span5'i><'span5'p>>",
  "sPaginationType": "bootstrap",

  "aoColumns": [
    {sWidth: "20%"},
    {sWidth: "60%"},
    {sWidth: "10%"},
    {sWidth: "10%"}
  ]
});
$.extend( $.fn.dataTableExt.oStdClasses, {
    "sWrapper": "dataTables_wrapper form-inline"
} );



} );
$(".destroy-button").on("click", function(){
  id = $(this).attr("id");
  del_index=$(this).data("zeile");
  $.getJSON('/ship_building_queues/destroy_queue/'+id, function(data){
    $('#shipdata').dataTable().fnDeleteRow( del_index );
    //if ... data.ok=1 ...  
    var i=0;
    $('#shipdata input[name="destroy"]').each(function(){
      $(this).attr("data-zeile",i);
      i++;
    });
  });
  

});

function deleteRow(i){


}
</script>





